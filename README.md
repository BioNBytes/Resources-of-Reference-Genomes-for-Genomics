## Resources on Reference Genomes and Annotations

This guide contains key concepts and summary of resources on reference genomes and annotations for human and mouse.

### 1. Reference Genome Assembly: Concepts and Hierarchies

- **Genome assembly** proceeds from sequencing reads → contigs → scaffolds → chromosomes, using technologies like BioNano optical mapping and Hi-C for scaffolding.
- **Scaffold types**:
    - **Placed**: Located at a specific position within a chromosome.
    - **Unlocalized**: Assigned to a chromosome but with uncertain position/orientation.
    - **Unplaced**: Chromosome of origin unknown.
- **Toplevel sequences** in Ensembl are all primary chromosomes plus any unlocalized/unplaced scaffolds.


### 2. Human Reference Genomes

| Version | Release | Key Features \& Limitations |
| :-- | :-- | :-- |
| **GRCh37** | 2009 | Legacy, includes alternate loci and patches, still used for compatibility. |
| **GRCh38** | 2013 | Current standard, 178 alternate loci (e.g., MHC), improved coverage, reduced errors. |
| **T2T-CHM13** | 2022 | First telomere-to-telomere assembly (except Y), filled last 8% of genome, added ~200Mbp, 1956 new genes. |
| **Pangenome** | 2023+ | Graph-based, incorporates 47+ individuals, adds 119Mbp, enhances variant detection and diversity. |

**Limitations:**

- T2T-CHM13 lacks the Y chromosome and, while more complete, represents a single haplotype, not population diversity.
- The pangenome addresses reference bias by representing a broader spectrum of human variation.


### 3. Mouse Reference Genomes

| Version | Release | UCSC Name | Notes |
| :-- | :-- | :-- | :-- |
| **GRCm39** | 2020 | mm39 | Current, major coordinate update, improved N50, closed gaps, new gene models, based on C57BL/6J. |
| **GRCm38** | 2011 | mm10 | Previous standard, still widely used in legacy datasets. |

- GRCm39 resolved 400+ issues, nearly doubled scaffold N50, and added 1.9 Mb of sequence.
- NCBI RefSeq Annotation Release 109 for GRCm39 includes >45,000 curated transcripts and new gene predictions.


### 4. Annotation Choice: Major Annotation Resources and Their Features

The choice of annotation source and format directly impacts mapping, quantification, and interpretation in genomics. Here is a detailed, accurate comparison of the most widely used resources:


| Resource | Source/Consortium | Annotation Set Name | Transcript/ID Format | Features | Canonical Transcript Selection |
| :-- | :-- | :-- | :-- | :-- | :-- |
| **NCBI RefSeq** | NCBI | RefSeq | NM_ (mRNA), NR_ (ncRNA), XP_, NP_ (protein) | Manually curated and computationally predicted gene models; provides a "representative" transcript per gene; broad organism coverage; non-redundant, well-annotated set.[^1] | Manual curation, functional evidence, conservation |
| **Ensembl** | EMBL-EBI | Ensembl Genes | ENSG (gene), ENST (transcript), ENSP (protein) | Automated, evidence-based pipeline; integrates GENCODE, RefSeq, UniProt, and RNA-seq; frequent updates; broad species support. | APPRIS (structural/functional evidence), expression, conservation |
| **GENCODE** | GENCODE Consortium | GENCODE | ENSG/ENST (same as Ensembl) | Most comprehensive and manually curated for human/mouse; merges Ensembl and HAVANA annotation; includes protein-coding, lncRNA, pseudogenes, sRNAs; used as default in GTEx/ENCODE. | Biological relevance, conservation, expression |
| **UCSC Genome Browser** | UCSC | UCSC Genes, refGene, ensGene, knownGene | uc\#\#\#\#\#\#\#.\# (UCSC), NM_/NR_ (refGene), ENST (ensGene) | Integrates tracks from RefSeq, GENCODE, Ensembl, comparative genomics; highly customizable for visualization; multiple annotation tracks. | Varies by source track; users must check source |
| **MANE** | NCBI + Ensembl | MANE Select / MANE Plus Clinical | NM_/ENST (matched) | One matched transcript per protein-coding gene, agreed upon by RefSeq and Ensembl; ideal for clinical and diagnostic use; high concordance. | Highest concordance, well-supported, biologically relevant |

#### Additional Details and Clarifications

- **NCBI RefSeq**:
    - Comprehensive, integrated, non-redundant, and well-annotated set of genomic, transcript, and protein sequences.[^1]
    - Provides both manually curated and computationally predicted gene models, and a "representative" transcript per gene is typically the most biologically validated or longest.
    - Covers over 165,000 organisms and is updated regularly (Release 230 as of May 2025).
    - Canonical transcripts are chosen based on manual curation, functional evidence, and evolutionary conservation.
- **Ensembl**:
    - Annotation is generated by an automated, evidence-based pipeline, integrating multiple data sources including GENCODE, RefSeq, UniProt, and RNA-seq data.
    - Transcript IDs are stable within a release but can change between releases.
    - Canonical transcripts are selected using APPRIS (structural/functional evidence), expression data, and conservation.
- **GENCODE**:
    - Merges Ensembl's automated annotation and HAVANA's manual curation, providing the most comprehensive and high-quality gene annotation for human and mouse.
    - Includes protein-coding genes, long non-coding RNAs, pseudogenes, and small RNAs.
    - Used as the default for major genomics projects (e.g., GTEx, ENCODE).
    - Canonical transcripts are prioritized by biological relevance, conservation, and expression.
- **UCSC Genome Browser**:
    - Integrates annotation tracks from RefSeq, GENCODE, Ensembl, and other sources, supporting visualization and custom queries.
    - Offers different annotation tracks (knownGene, refGene, ensGene), and users must be careful to select the appropriate track for their analysis.
    - Transcript IDs vary by track: UCSC Genes use uc\#\#\#\#\#\#\#.\#, refGene uses NM_/NR_, and ensGene uses ENST.
- **MANE (Matched Annotation from NCBI and Ensembl)**:
    - Provides a single, matched transcript per protein-coding gene, agreed upon by both RefSeq and Ensembl, ensuring consistency for clinical and diagnostic pipelines.
    - MANE Select is the main transcript, while MANE Plus Clinical includes additional clinically relevant transcripts.
    - Canonical transcript selection is based on highest concordance and biological support.


#### Impact on Analysis

- Annotation source and complexity directly affect RNA-seq mapping, quantification, and downstream interpretation.
- Only a minority of genes have identical quantification across resources due to differences in transcript models, exon-intron structures, and curation approaches.
- For human and mouse, GENCODE is recommended for transcriptomics, NCBI RefSeq for clinical/curated needs, Ensembl for broad discovery, and UCSC Table Browser for custom, region-focused analyses.
- Always document the source, version, and genome build of the annotation file used.


### 5. Genome Annotation Formats: GTF vs GFF3

| Format | Features | Best Use Cases |
| :-- | :-- | :-- |
| **GTF** | Simpler, widely used for RNA-seq, two-level hierarchy (gene→transcript), flexible. | Quantification, legacy tools |
| **GFF3** | Structured, supports multi-level relationships (gene→transcript→exon), richer metadata. | Submissions, complex features |

- GFF3 is more standardized and supports richer annotation, but both are accepted for many pipelines.
- Format inconsistencies (especially in UCSC GTFs) can cause downstream issues.


### 6. Special Topics

**Alternate Loci and Patches (Human):**

- GRCh38 includes 178 alternate loci for regions like MHC, allowing representation of population variation.
- Patches (novel/fix) provide updates without changing coordinate systems; incorporated into next major releases.

**Decoy Genomes:**

- Used to reduce misalignments, especially for repetitive regions or unassembled sequence.

**Graph-based Pangenomes:**

- Represent multiple haplotypes/alleles, improving variant detection and reducing reference bias.


### 7. Programmatic Access: Mouse Gene Example

Below are code examples for retrieving canonical transcript IDs for mouse genes (adaptable for human) from both NCBI and Ensembl.

#### **A. Retrieving Canonical NCBI RefSeq Transcript for a Mouse Gene**

```python
import requests
from xml.etree import ElementTree as ET

def get_ncbi_canonical_transcript(gene_symbol, organism="Mus musculus"):
    # Step 1: Use esearch to get the Gene ID for the given gene symbol and organism
    search_url = "https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi"
    search_params = {
        "db": "gene",
        "term": f"{gene_symbol}[Gene Name] AND {organism}[Organism]",
        "retmode": "json"
    }
    response = requests.get(search_url, params=search_params)
    gene_id_list = response.json()["esearchresult"]["idlist"]

    if not gene_id_list:
        return f"No gene found for {gene_symbol}"

    gene_id = gene_id_list[^0]

    # Step 2: Use elink to find RefSeq RNA nucleotide records linked to the Gene ID
    link_url = "https://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi"
    link_params = {
        "dbfrom": "gene",
        "db": "nucleotide",
        "id": gene_id,
        "retmode": "json",
        "linkname": "gene_nuccore_refseqrna"
    }
    response = requests.get(link_url, params=link_params)
    try:
        linked_ids = response.json()["linksets"][^0]["linksetdbs"][^0]["links"]
    except (KeyError, IndexError):
        return f"No RefSeq transcripts found for {gene_symbol}"

    # Step 3: Use esummary to get detailed transcript info (limit to first 50 IDs)
    ids_str = ",".join(linked_ids[:50])
    summary_url = "https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi"
    summary_params = {
        "db": "nucleotide",
        "id": ids_str,
        "retmode": "xml"
    }
    response = requests.get(summary_url, params=summary_params)
    root = ET.fromstring(response.content)

    # Step 4: Filter for curated NM_ (RefSeq mRNA) accessions
    transcripts = []
    for docsum in root.findall(".//DocSum"):
        accession = None
        for item in docsum.findall("Item"):
            if item.attrib.get("Name") == "Caption":
                if item.text.startswith("NM_"):
                    accession = item.text
        if accession:
            transcripts.append(accession)

    if transcripts:
        # Return the first NM_ accession as canonical (commonly used convention)
        return transcripts[^0]
    else:
        return f"No NM_ (curated) transcripts found for {gene_symbol}"

# Example usage
gene_symbol = "Kras"
canonical_transcript_id = get_ncbi_canonical_transcript(gene_symbol)
print(f"Canonical NCBI transcript for {gene_symbol}: {canonical_transcript_id}")
```

**Notes:**

- NM_ accessions represent curated mRNA transcripts in RefSeq and are widely used as canonical references.
- For some genes, multiple NM_ accessions may exist; the first is often used by convention, but users should check NCBI for gene-specific canonical definitions.
- For batch queries, wrap this function in a loop and handle API rate limits.


#### **B. Retrieving Canonical Ensembl Transcript for a Mouse Gene**

```python
import requests

gene_symbol = "Kras"  # Mouse gene symbol, e.g., "Kras"
server = "https://rest.ensembl.org"
ext = f"/lookup/symbol/mus_musculus/{gene_symbol}?expand=1"

headers = {"Content-Type": "application/json"}
r = requests.get(server + ext, headers=headers)

if not r.ok:
    r.raise_for_status()

data = r.json()

# The 'canonical_transcript' field contains the Ensembl transcript ID designated as canonical
canonical_transcript_id = data.get('canonical_transcript')
print(f"Canonical Ensembl transcript for {gene_symbol}: {canonical_transcript_id}")
```

**Notes:**

- The canonical transcript in Ensembl is selected based on biological relevance and transcript completeness, and may differ from NCBI's choice.
- The transcript ID returned (e.g., ENSMUST000000XXXXXX) can be used to fetch sequence or further annotation via other Ensembl endpoints.
- For human, change `mus_musculus` to `homo_sapiens` in the URL.


#### **C. Additional Tips for Programmatic Access**

- **API Rate Limits:** Both NCBI and Ensembl APIs have request limits. For large-scale queries, add delays and monitor usage.
- **Annotation Versioning:** Always record the date and version of the database used for reproducibility.
- **Canonical Transcript Definitions:** The definition of "canonical" may differ between databases. For critical applications (e.g., clinical), consult database documentation or use gene-specific curation.
- **Batch Processing:** Both scripts can be adapted for batch processing by iterating over a list of gene symbols.


### 8. Additional Key Points and Resources

- **Species-specific databases** (e.g., Wormbase, Flybase) and AWS iGenomes exist, but may be outdated.
- **Chromosome naming conventions** differ by platform (e.g., NCBI/Ensembl: 1,2,...,X,Y,MT; UCSC: chr1, chr2, ..., chrM).
- **Annotation files should use stable gene IDs** (not gene symbols) for consistency across versions.
- **Quality control**: Use annotation files with a `gene_biotype` field for best results in automated pipelines.
- **Download locations**: NCBI, Ensembl, GENCODE, and UCSC all provide FTP and browser-based access to assemblies and annotations.


### 9. References

1. Haibo Liu, LinkedIn. [Notes on reference genome resources](https://www.linkedin.com/feed/update/urn:li:activity:7309376644169752577/?originTrackingId=1OaGKrcAQMub5NqA11hTZw%3D%3D)
2. UCSC News: Human pangenome. https://news.ucsc.edu/2023/05/pangenome-draft/
3. NCBI Insights: GRCm39. https://ncbiinsights.ncbi.nlm.nih.gov/2020/10/16/refseq-grcm39/
4. Comparison of human (and other) genome browsers. PMC3525149. https://pmc.ncbi.nlm.nih.gov/articles/PMC3525149/
5. excluderanges: exclusion sets for T2T-CHM13, GRCm39. https://www.biorxiv.org/content/10.1101/2022.11.21.517407v1.full.pdf
6. GENCODE 2025: reference gene annotation for human and mouse. Nucleic Acids Res 2025;53:D966-D975. https://pubmed.ncbi.nlm.nih.gov/39565199/
7. Morales J, et al. A joint NCBI and EMBL-EBI transcript set for clinical genomics and research. Nature 2022;604:310–315.
8. GENCODE Publications. https://www.gencodegenes.org/pages/publications.html
9. NCBI: Annotating Genomes with GFF3 or GTF files. https://www.ncbi.nlm.nih.gov/genbank/genomes_gff
10. A comprehensive evaluation of Ensembl, RefSeq, and UCSC annotations in the context of RNA-seq read mapping and gene quantification. BMC Genomics. 2015;16:97.
11. Feature annotation: RefSeq vs Ensembl vs Gencode, what's the difference? Bioinformatics Stack Exchange, 2017.
12. The UCSC Table Browser data retrieval tool. Nucleic Acids Res. 2004;32(Database issue):D493–D496.
13. UCSC Genome Browser (and refGene) vs NCBI Gene (RefSeq). UCSC Genome Browser Public Support, 2013.

<div style="text-align: center">⁂</div>
